<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Jeu</title>
  <!-- Styles éléments du jeu -->
  <link rel="stylesheet" href="styles/game/elements/cards-declared.css">
  <link rel="stylesheet" href="styles/game/elements/cards-declared-player.css">
  <link rel="stylesheet" href="styles/game/elements/cards-hand-player.css">
  <link rel="stylesheet" href="styles/game/elements/cards-played.css">
  <link rel="stylesheet" href="styles/game/elements/declaration-computer.css">
  <link rel="stylesheet" href="styles/game/elements/decl-totals-popover.css">
  <link rel="stylesheet" href="styles/game/elements/end-round.css">
  <link rel="stylesheet" href="styles/game/elements/game_difficulties.css">
  <link rel="stylesheet" href="styles/game/elements/main.css">
  <link rel="stylesheet" href="styles/game/elements/result-trick-game.css">
  <link rel="stylesheet" href="styles/game/elements/score-bowdlerized.css">
  <link rel="stylesheet" href="styles/game/elements/score-normal.css">
  <link rel="stylesheet" href="styles/game/elements/stack.css">
  <link rel="stylesheet" href="styles/game/elements/trick.css">
  <link rel="stylesheet" href="styles/game/elements/trump.css">
  <link rel="stylesheet" href="styles/game/elements/headers.css">
  <link rel="stylesheet" href="styles/game/elements/correct.css">
  <link rel="stylesheet" href="styles/game/elements/ai-emotion.css">

  <!-- Styles modales du jeu -->
  <link rel="stylesheet" href="styles/game/modales/difficulty-modal.css">
  <link rel="stylesheet" href="styles/game/modales/main-modal.css">
  <link rel="stylesheet" href="styles/game/modales/root.css">
  <link rel="stylesheet" href="styles/game/modales/modal_box.css">
  <link rel="stylesheet" href="styles/game/modales/trick-result.css">
  <link rel="stylesheet" href="styles/game/modales/decl-modal.css">
  <link rel="stylesheet" href="styles/game/modales/modal_actions.css">
  <link rel="stylesheet" href="styles/game/modales/player-decl-modal.css">
  <link rel="stylesheet" href="styles/game/modales/end-of-round.css">
  <link rel="stylesheet" href="styles/game/modales/end-of-game.css">
  <link rel="stylesheet" href="styles/game/modales/mini-info-bar.css">
  <link rel="stylesheet" href="styles/game/modales/mini-overlay.css">
  <link rel="stylesheet" href="styles/game/modales/session-modal.css">

  <!-- Styles autres pages -->
  <link rel="stylesheet" href="styles/pages/rules.css">
  <link rel="stylesheet" href="styles/pages/home.css">
  <link rel="stylesheet" href="styles/pages/home-table.css">
  <link rel="stylesheet" href="styles/pages/charts.css">
  <link rel="stylesheet" href="styles/pages/boutons.css">
</head>
<body class="body">
  <!-- Pistes musicales (on cache les contrôles natifs) -->
  <audio id="musicAccueil" src="./sons/musiques/accueil.mp3" preload="auto" loop></audio>
  <audio id="musicJeu"     src="./sons/musiques/jeu.mp3"     preload="auto" loop></audio>

  <!-- Panneau audio custom -->
  <div class="audio-panel">
    <button id="btnMusicToggle" title="Play/Pause">⏯</button>
    <label>Musique
      <input id="rngMusic" type="range" min="0" max="1" step="0.01">
    </label>
    <label>Bruitages
      <input id="rngSfx" type="range" min="0" max="1" step="0.01">
    </label>
    <button id="btnCommentsToggle" title="Activer/Désactiver les commentaires">
      <img src="images/comment.svg"    class="icon-comment icon-on">
      <img src="images/noComment.svg" class="icon-comment icon-off">
    </button>
     <!-- Présence / Réactions IA -->
    <button id="btnIaToggle" title="Activer/Désactiver la présence des personnages IA">
      <img src="images/IA.svg"    class="icon-ia icon-on">
      <img src="images/noIA.svg" class="icon-ia icon-off">
    </button>
  </div>

  <!-- Indicateur connexion -->
  <div id="session-indicator" class="session-indicator">
    <span class="session-indicator_label">Session :</span>
    <span id="session-indicator_name" class="session-indicator_name">Invité</span>
  </div>

  <!-- Modal loggin -->
  <div id="session-modal" class="modal-root">
    <div class="modal session-modal">
      <header class="session-modal_header">
        <h2 class="session-modal_title">Choisir une session</h2>
        <p class="session-modal_subtitle">
          Sélectionne un joueur enregistré ou crée une nouvelle session.
        </p>
      </header>

      <!-- Liste des sessions existantes (boutons générés en JS) -->
      <div id="session-modal_list" class="session-modal_list">
        <!--
        Exemple de rendu JS :

        <button type="button" class="session-btn" data-username="Nicolas">
          <span class="session-btn_name">Nicolas</span>
          <span class="session-btn_hint">Cliquer pour rejoindre</span>
        </button>
        -->
      </div>

      <!-- Zone de création de nouvelle session -->
      <div class="session-modal_new">
        <button
          id="session-modal_newBtn"
          type="button"
          class="btn validate session-create-btn"
        >
          + Créer une nouvelle session
        </button>

        <div id="session-modal_newForm" class="session-modal_newForm">
          <label for="session-modal_newName" class="session-modal_label">
            Nom de la nouvelle session
          </label>
          <div class="session-modal_newRow">
            <input
              id="session-modal_newName"
              type="text"
              class="session-modal_input"
              placeholder="Nom du joueur"
            >
            <button
              id="session-modal_confirmNew"
              type="button"
              class="btn validate"
            >
              Valider
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  
  <!-- Adversaire -->
  <div id="ai-emotion-box" class="ai-emotion-box">
    <img id="ai-emotion-img"
        class="ai-emotion-img"
        src="images/adversaires/emotions/Perrot_joie.svg"
        alt="Humeur de l'adversaire">
    <p id="ai-emotion-text" class="ai-emotion-text">
      Allons-y, je suis prêt à jouer !
    </p>
  </div>

  <!-- ÉCRAN 1 : ACCUEIL (par défaut) -->
  <section id="screen-home" class="screen screen--active">
    <div class="home wrap">
      <!-- HERO -->
      <header class="home__header">
        <h1 id="home-title">Jeu du Brézin</h1>
        <p class="home__subtitle">Un jeu traditionnel du Berry, pensé pour 2 joueurs</p>

        <div class="home__cta">
          <button class="btn" data-goto="game">Jouer une partie</button>
          <a class="btn-link" data-goto="rules" id="btn-open-rules">Voir les règles</a>
          <button id="btn-session-switch" class="btn validate session-switch-btn">
            Changer de session
          </button>
        </div>
      </header>

      <!-- RÉSUMÉ HISTORIQUE -->
      <section class="home__block" aria-labelledby="home-origin">
        <h2 id="home-origin">Origine et transmission</h2>
        <p class="home__lead">
          Le Brézin est un ancien jeu de cartes originaire du Berry, province historique centrée autour de Bourges.
          Bien que l’entité administrative ait disparu après la Révolution, sa culture a perduré, et le Brézin en est un témoignage.
        </p>
        <p>
          Dans ma famille, une branche a vécu près de Levroux et Châteauroux. Sans avoir grandi sur place, j’ai reçu ce jeu
          par transmission orale, de génération en génération. Le Brézin se distingue par un atout rare&nbsp;: il se joue à deux,
          tout en restant un jeu “évolué”. Aujourd’hui il n’est presque plus pratiqué et ses règles se sont diffusées surtout par récits.
        </p>
        <p>
          Ce jeu a pour objectif de préserver et partager ces règles de manière ludique&nbsp;: en y jouant.
        </p>
      </section>

      <!-- STAT CARDS / KPI -->
      <section class="home__block" aria-labelledby="home-kpi">
        <h2 id="home-kpi">Aperçu des résultats</h2>
        <div class="diff-tabs" role="tablist" aria-label="Niveau de difficulté">
          <button class="diff-tab" role="tab" data-diff="easy"   aria-selected="false">Facile</button>
          <button class="diff-tab" role="tab" data-diff="normal" aria-selected="true">Normal</button>
          <button class="diff-tab" role="tab" data-diff="hard"   aria-selected="false">Difficile</button>
          <button class="diff-tab" role="tab" data-diff="expert" aria-selected="false">Expert</button>
        </div>

        <!-- Profil de l'IA courante -->
        <article class="ai-profile" aria-label="Profil de l'adversaire">
          <div class="ai-profile__avatar">
            <img
              id="ai-profile-img"
              src="./images/adversaires/emotions/Radegonde_joie.svg"
              alt="Radegonde, guérisseuse du Berry"
              loading="lazy"
            >
          </div>
          <div class="ai-profile__content">
            <p class="ai-profile__name" id="ai-profile-name">
              Radegonde, guérisseuse du Berry
            </p>
            <p class="ai-profile__subtitle" id="ai-profile-subtitle">
              Niveau facile · Adversaire indulgente et bavarde
            </p>
            <p class="ai-profile__desc" id="ai-profile-desc">
              Radegonde joue pour le plaisir plus que pour la gagne. Elle commet des bourdes,
              rit de ses erreurs et commente chaque pli à sa manière de vieille guérisseuse berrichonne.
              Idéale pour découvrir tranquillement le Brézin.
            </p>
          </div>
        </article>

        <div class="kpi-grid">
          <div class="kpi-card">
            <div class="kpi-label">Parties jouées</div>
            <div class="kpi-value" id="kpi-games-played">0</div>
          </div>
          <div class="kpi-card">
            <div class="kpi-label">Taux de victoire</div>
            <div class="kpi-value" id="kpi-winrate-player">0%</div>
          </div>
          <div class="kpi-card">
            <div class="kpi-label">Score moyen</div>
            <div class="kpi-value" id="kpi-avgscore-player">0</div>
          </div>
          <div class="kpi-card">
            <div class="kpi-label">Écart moyen</div>
            <div class="kpi-value" id="kpi-avg-gap">0</div>
          </div>
        </div>
      </section>

      <!-- CHARTS -->
      <section class="home__block" aria-labelledby="home-charts">
        <h2 id="home-charts">Graphiques</h2>

        <div class="charts-grid">
          <!-- Répartition des issues (camembert) -->
          <article class="chart-card" aria-labelledby="chart-outcomes-title">
            <h3 id="chart-outcomes-title">Issues des parties</h3>
            <div class="chart-area" id="chart-outcomes" role="img" aria-label="Répartition victoires joueur / ordinateur / égalités">
              <!-- Canvas ou SVG injecté en JS -->
            </div>
          </article>

          <!-- Progression des scores (courbe) -->
          <article class="chart-card" aria-labelledby="chart-scores-title">
            <h3 id="chart-scores-title">Scores finaux au fil du temps</h3>
            <div class="chart-area" id="chart-scores" role="img" aria-label="Courbes des scores finaux des parties">
              <!-- Canvas ou SVG injecté en JS -->
            </div>
          </article>

          <!-- Histogramme écarts -->
          <article class="chart-card" aria-labelledby="chart-gap-title">
            <h3 id="chart-gap-title">Distribution des écarts</h3>
            <div class="chart-area" id="chart-gap" role="img" aria-label="Histogramme des écarts de score">
              <!-- Canvas ou SVG injecté en JS -->
            </div>
          </article>

          <!-- Radar annonces -->
          <article class="chart-card" aria-labelledby="chart-decls-title">
            <h3 id="chart-decls-title">Annonces les plus fréquentes</h3>
            <div class="chart-area" id="chart-declarations" role="img" aria-label="Répartition des annonces (Couples, Carrés, 7 d'atout, 250, Brézin, Grand Brézin)">
              <!-- Canvas ou SVG injecté en JS -->
            </div>
          </article>
        </div>
      </section>

      <!-- DERNIÈRES PARTIES -->
      <section class="home__block" aria-labelledby="home-recent">
        <h2 id="home-recent">Dernières parties</h2>
        <div class="table-scroll">
          <table class="home-table" id="table-recent-games">
            <thead>
              <tr>
                <th>Date</th>
                <th>Heure</th>
                <th>Vainqueur</th>
                <th>Score Joueur</th>
                <th>Score Ordinateur</th>
                <th>Écart</th>
                <th>Annonces Joueur</th>
                <th>Annonces Ordinateur</th>
              </tr>
            </thead>
            <tbody>
              <!-- Lignes injectées en JS à partir du CSV / stockage -->
            </tbody>
          </table>
        </div>
      </section>
    </div>
  </section>

  <!-- ÉCRAN 2 : RÈGLES -->
  <section id="screen-rules" class="screen">
    <div class="rules wrap">

      <header class="rules__header">
        <h1 id="rules-title">Règles du jeu – Le Brézin</h1>
        <p class="rules__subtitle">Deux joueurs – Deux jeux de 32 cartes – Objectif 1000 points</p>
      </header>
      <button class="btn" data-goto="game">Lancer le jeu</button>
      <button class="btn alt" data-goto="home">Retour accueil</button>

      <!-- 1. OBJECTIF -->
      <section class="rules__block" aria-labelledby="rules-objectif">
        <h2 id="rules-objectif">1) Objectif</h2>
        <p>
          Le Brézin se joue en tête-à-tête. L’objectif est de dépasser les
          <strong>1000 points</strong> avant votre adversaire, tout en ayant un
          <strong>score supérieur</strong> au moment où ce seuil est franchi.
        </p>
        <p>Deux façons de marquer des points&nbsp;:</p>
        <ul>
          <li>en remportant des plis contenant des <strong>10</strong> et des <strong>As</strong> ;</li>
          <li>et surtout grâce aux <strong>annonces</strong>, qui rapportent beaucoup plus.</li>
        </ul>
      </section>

      <!-- 2. DONNE & ATOUT -->
      <section class="rules__block" aria-labelledby="rules-donne-atout">
        <h2 id="rules-donne-atout">2) Donne et atout</h2>
        <ul>
          <li>On utilise <strong>deux jeux de 32 cartes</strong>, soit <strong>64 cartes</strong> au total.</li>
          <li>Chaque paquet contient&nbsp;: 7, 8, 9, Valet, Dame, Roi, 10 et As dans les quatre couleurs.</li>
          <li>Chaque carte existe donc en <strong>double</strong> (par exemple&nbsp;: deux 7 de Trèfle, deux Dames de Carreau, etc.).</li>
          <li>On distribue <strong>9 cartes</strong> à chaque joueur, <strong>trois par trois</strong>.</li>
          <li>Une carte est posée <strong>face visible au centre</strong> : elle détermine la <strong>couleur d’atout</strong> pour toute la manche.</li>
          <li>Le reste des cartes forme le <strong>talon</strong> (la pioche).</li>
          <li><strong>Qui commence&nbsp;?</strong> À la première manche, on tire au sort. À la manche suivante, les rôles de donneur et de premier joueur s’inversent.</li>
        </ul>
      </section>

      <!-- 3. PHASES DU JEU -->
      <section class="rules__block" aria-labelledby="rules-phases">
        <h2 id="rules-phases">3) Phases du jeu</h2>
        <ul>
          <li><a href="#rules-plis">1. Le jeu des plis</a></li>
          <li><a href="#rules-annonces">2. Les annonces</a></li>
          <li><a href="#rules-fin">3. Fin de manche</a></li>
        </ul>
      </section>

      <!-- 4. LE JEU DES PLIS -->
      <section class="rules__block" aria-labelledby="rules-plis">
        <h2 id="rules-plis">4) Le jeu des plis</h2>

        <h3>Déroulement d’un tour (tant qu’il reste des cartes à piocher)</h3>
        <ul>
          <li>Le joueur qui a remporté le pli précédent <strong>pioche une carte</strong> dans le talon, puis <strong>joue une carte</strong> de son choix.</li>
          <li>Le second joueur <strong>pioche à son tour</strong>, puis joue une carte de son choix.</li>
          <li>Le pli est attribué, puis le vainqueur entame le tour suivant.</li>
        </ul>

        <h3>Attribution du pli</h3>
        <ul>
          <li>Si les deux cartes sont de la <strong>même couleur</strong>, la <strong>plus forte</strong> remporte le pli.</li>
          <li>Si deux cartes identiques sont jouées, la <strong>première jouée</strong> remporte le pli.</li>
          <li>Si le second joueur change de couleur, il perd le pli, sauf s’il <strong>joue de l’atout</strong> (dans ce cas il gagne le pli).</li>
          <li>Si les deux joueurs jouent de l’atout, la <strong>plus forte carte d’atout</strong> remporte le pli.</li>
        </ul>

        <h3>Ordre des cartes (de la plus faible à la plus forte)</h3>
        <p><code>7 – 8 – 9 – Valet – Dame – Roi – 10 – As</code></p>
        <p>Cette hiérarchie est la même pour les <strong>atouts</strong>.</p>

        <p>Les cartes jouées sont placées face cachée dans le <strong>tas de plis</strong> du joueur qui les a remportées.</p>
      </section>

      <!-- 5. LES POINTS DES PLIS -->
      <section class="rules__block" aria-labelledby="rules-points-plis">
        <h2 id="rules-points-plis">5) Points gagnés dans les plis</h2>
        <ul>
          <li>Chaque pli contenant un <strong>10</strong> ou un <strong>As</strong> rapporte <strong>10 points</strong> au joueur qui remporte le pli.</li>
          <li>En fin de manche, on recompte tous les 10 et As des plis ramassés&nbsp;: chaque carte vaut <strong>10 points</strong>.</li>
        </ul>
      </section>

      <!-- 6. LES ANNONCES : PRINCIPE GENERAL -->
      <section class="rules__block" aria-labelledby="rules-annonces">
        <h2 id="rules-annonces">6) Les annonces</h2>

        <p>Les annonces sont des <strong>combinaisons de cartes</strong> qui rapportent beaucoup de points. Elles constituent le cœur stratégique du Brézin.</p>

        <h3>Conditions générales pour annoncer</h3>
        <ul>
          <li>On ne peut annoncer qu’<strong>immédiatement après avoir remporté un pli</strong>.</li>
          <li>Pour annoncer, il faut <strong>conserver les cartes nécessaires dans sa main</strong>, en anticipant les pioches (la main est limitée en pratique à 9 cartes utiles).</li>
          <li>Pour chaque nouvelle annonce, <strong>au moins une carte</strong> de la combinaison doit être <strong>neuve</strong>, c’est-à-dire <strong>n’avoir encore jamais servi dans une annonce</strong>.</li>
          <li>Les cartes ayant servi à une annonce sont placées <strong>face visible</strong> devant le joueur, mais elles restent <strong>jouables</strong> plus tard dans les plis.</li>
          <li>Une carte peut servir à <strong>plusieurs types d’annonces</strong>, mais pas forcément plusieurs fois au même type (voir ci-dessous).</li>
          <li>Les carrés ont une règle particulière&nbsp;: si un joueur a déjà annoncé un carré d’un rang donné, il lui suffit de posséder <strong>3 nouvelles cartes du même rang</strong> pour annoncer un second carré, en réutilisant <strong>une seule carte</strong> du premier carré.</li>
        </ul>

        <!-- ==================== COUPLES ==================== -->
        <h4>Couples (Dame + Roi de même couleur)</h4>
        <ul>
          <li><strong>20 points</strong> pour un couple simple.</li>
          <li><strong>40 points</strong> pour un <strong>couple d’atout</strong>.</li>
          <li>Une Dame ou un Roi ayant servi dans un couple ne peut plus servir dans un autre couple, mais peut encore servir pour un carré, le 40 de Brézin, le 250 ou le Brézin.</li>
        </ul>

        <div class="rules__example">
          <p class="rules__example-title">Exemples de couples :</p>

          <!-- Couple simple -->
          <figure class="rules__example-figure">
            <figcaption>Couple simple (20 points)&nbsp;: Dame et Roi de Cœur</figcaption>
            <div class="rules__cards-row">
              <img class="rules__card" src="images/dame_de_coeur.svg" alt="Dame de Cœur" loading="lazy" decoding="async">
              <img class="rules__card" src="images/roi_de_coeur.svg" alt="Roi de Cœur" loading="lazy" decoding="async">
            </div>
          </figure>

          <!-- Couple d'atout -->
          <figure class="rules__example-figure">
            <figcaption>Couple d’atout (40 points)&nbsp;: Dame et Roi d’atout (ici Trèfle)</figcaption>
            <div class="rules__cards-row">
              <img class="rules__card" src="images/dame_de_trèfle.svg" alt="Dame de Trèfle" loading="lazy" decoding="async">
              <img class="rules__card" src="images/roi_de_trèfle.svg" alt="Roi de Trèfle" loading="lazy" decoding="async">
            </div>
          </figure>
        </div>

        <!-- ==================== CARRES ==================== -->
        <h4>Carrés (4 cartes de même rang)</h4>
        <p>Seuls les carrés de Valets, Dames, Rois et As rapportent des points&nbsp;:</p>
        <table class="rules__table">
          <thead>
            <tr><th>Rang</th><th>Points</th></tr>
          </thead>
          <tbody>
            <tr><td>Valets</td><td>40</td></tr>
            <tr><td>Dames</td><td>60</td></tr>
            <tr><td>Rois</td><td>80</td></tr>
            <tr><td>As</td><td>100</td></tr>
          </tbody>
        </table>
        <p>Les autres carrés (7, 8, 9, 10) ne rapportent <strong>aucun point</strong>.</p>

        <div class="rules__example">
          <p class="rules__example-title">Exemple&nbsp;: Carré de Dames (60 points)</p>
          <div class="rules__cards-row">
            <img class="rules__card" src="images/dame_de_pique.svg"   alt="Dame de Pique" loading="lazy" decoding="async">
            <img class="rules__card" src="images/dame_de_coeur.svg"  alt="Dame de Cœur" loading="lazy" decoding="async">
            <img class="rules__card" src="images/dame_de_carreau.svg" alt="Dame de Carreau" loading="lazy" decoding="async">
            <img class="rules__card" src="images/dame_de_trèfle.svg" alt="Dame de Trèfle" loading="lazy" decoding="async">
          </div>

          <p class="rules__example-title">Autre exemple&nbsp;: Carré de Rois (80 points)</p>
          <div class="rules__cards-row">
            <img class="rules__card" src="images/roi_de_pique.svg"   alt="Roi de Pique" loading="lazy" decoding="async">
            <img class="rules__card" src="images/roi_de_coeur.svg"   alt="Roi de Cœur" loading="lazy" decoding="async">
            <img class="rules__card" src="images/roi_de_carreau.svg" alt="Roi de Carreau" loading="lazy" decoding="async">
            <img class="rules__card" src="images/roi_de_trèfle.svg"  alt="Roi de Trèfle" loading="lazy" decoding="async">
          </div>
        </div>

        <!-- ==================== 7 D'ATOUT ==================== -->
        <h4>Le 7 d’atout</h4>
        <ul>
          <li>Annoncer un <strong>7 de la couleur d’atout</strong> rapporte <strong>10 points</strong>.</li>
          <li>Le 7 d’atout permet de <strong>récupérer la carte d’atout visible au centre</strong>, en l’échangeant avec ce 7.</li>
          <li>Le 7 d’atout est la <strong>seule annonce</strong> pouvant se <strong>cumuler avec une autre annonce</strong> au même moment.</li>
        </ul>

        <div class="rules__example">
          <p class="rules__example-title">Exemple de 7 d’atout&nbsp;: ici l’atout est Trèfle</p>
          <div class="rules__cards-row">
            <img class="rules__card" src="images/7_de_trèfle.svg" alt="7 de Trèfle" loading="lazy" decoding="async">
            <img class="rules__card" src="images/trèfle.svg"      alt="Symbole d’atout Trèfle" loading="lazy" decoding="async">
          </div>
        </div>

        <!-- ==================== 40 DE BREZIN ==================== -->
        <h4>Le 40 de Brézin</h4>
        <p><strong>Valet de Pique + Dame de Carreau</strong> : <strong>40 points</strong>.</p>

        <div class="rules__example">
          <p class="rules__example-title">Exemple de 40 de Brézin</p>
          <div class="rules__cards-row">
            <img class="rules__card" src="images/valet_de_pique.svg"   alt="Valet de Pique" loading="lazy" decoding="async">
            <img class="rules__card" src="images/dame_de_carreau.svg"  alt="Dame de Carreau" loading="lazy" decoding="async">
          </div>
        </div>

        <!-- ==================== 250 ==================== -->
        <h4>Le 250</h4>
        <p>Une combinaison de 5 cartes d’atout&nbsp;: <strong>Valet, Dame, Roi, 10 et As d’atout</strong> vaut <strong>250 points</strong>.</p>

        <div class="rules__example">
          <p class="rules__example-title">Exemple de 250&nbsp;: Valet, Dame, Roi, 10 et As d’atout (ici Carreau)</p>
          <div class="rules__cards-row">
            <img class="rules__card" src="images/valet_de_carreau.svg" alt="Valet de Carreau" loading="lazy" decoding="async">
            <img class="rules__card" src="images/dame_de_carreau.svg"  alt="Dame de Carreau" loading="lazy" decoding="async">
            <img class="rules__card" src="images/roi_de_carreau.svg"   alt="Roi de Carreau" loading="lazy" decoding="async">
            <img class="rules__card" src="images/10_de_carreau.svg"    alt="10 de Carreau" loading="lazy" decoding="async">
            <img class="rules__card" src="images/as_de_carreau.svg"    alt="As de Carreau" loading="lazy" decoding="async">
          </div>
        </div>

        <!-- ==================== BREZIN ==================== -->
        <h4>Le Brézin</h4>
        <p>La combinaison la plus rare&nbsp;: <strong>deux Valets de Pique</strong> et <strong>deux Dames de Carreau</strong>. Elle vaut <strong>500 points</strong>.</p>

        <div class="rules__example">
          <p class="rules__example-title">Exemple de Brézin</p>
          <div class="rules__cards-row">
            <!-- on affiche simplement deux fois chaque carte -->
            <img class="rules__card" src="images/valet_de_pique.svg"   alt="Valet de Pique" loading="lazy" decoding="async">
            <img class="rules__card" src="images/valet_de_pique.svg"   alt="Valet de Pique" loading="lazy" decoding="async">
            <img class="rules__card" src="images/dame_de_carreau.svg"  alt="Dame de Carreau" loading="lazy" decoding="async">
            <img class="rules__card" src="images/dame_de_carreau.svg"  alt="Dame de Carreau" loading="lazy" decoding="async">
          </div>
        </div>

        <!-- ==================== CARTES EXPOSEES & REUTILISATION ==================== -->
        <h3>Cartes exposées et réutilisation</h3>
        <ul>
          <li>Les cartes ayant servi à une annonce restent <strong>exposées face visible</strong>, mais elles peuvent toujours être jouées dans les plis.</li>
          <li>On ne peut annoncer qu’<strong>une combinaison à la fois</strong>, sauf dans le cas du <strong>7 d’atout</strong> qui peut se cumuler avec une autre annonce.</li>
          <li>Une carte ayant servi à un <strong>couple</strong> ne peut plus former un autre couple, mais peut servir à un <strong>carré</strong> ou à d’autres annonces (40 de Brézin, 250, Brézin).</li>
          <li>Pour chaque nouvelle annonce, il doit toujours y avoir <strong>au moins une carte neuve</strong>, n’ayant jamais été annoncée.</li>
          <li>Pour les <strong>carrés</strong>, une seule carte d’un carré déjà annoncé peut être réutilisée pour un nouveau carré du même rang.</li>
          <li>Une <strong>carte déjà jouée dans un pli</strong> ne peut plus servir à une annonce.</li>
        </ul>
      </section>

      <!-- 7. FIN DE MANCHE & OBLIGATIONS APRES LA PIOCHE -->
      <section class="rules__block" aria-labelledby="rules-fin">
        <h2 id="rules-fin">7) Fin de manche&nbsp;: épuisement de la pioche</h2>

        <h3>Lorsque l'on arrive a la fin de la pioche</h3>
        <ul>
          <li>le joueur qui a remporté le dernier pli prend la <strong>dernière carte</strong> de la pioche&nbsp;;</li>
          <li>l’autre joueur récupère la <strong>carte d’atout visible</strong> dans sa main&nbsp;;</li>
          <li>toutes les cartes annoncées, posées face visible, <strong>reviennent en main</strong> ;</li>
          <li>les <strong>annonces ne sont plus possibles</strong> jusqu’à la fin de la manche.</li>
        </ul>

        <h3>Obligations de jeu après épuisement de la pioche</h3>
        <p>À partir de ce moment, le joueur qui joue en second n’est plus libre de jouer ce qu’il veut&nbsp;:</p>
        <ul>
          <li>
            S’il possède la <strong>couleur demandée</strong>, il doit la fournir,
            <strong>même si cela l’oblige à jouer un 10 ou un As</strong>.
          </li>
          <li>
            S’il ne possède pas la couleur demandée mais possède de l’<strong>atout</strong>,
            il doit <strong>couper à l’atout</strong>.
          </li>
          <li>
            Si la première carte jouée est un <strong>atout</strong> et que le second joueur possède
            un atout plus fort, il doit <strong>surcouper</strong> (jouer un atout plus puissant).
          </li>
          <li>
            S’il ne possède ni la couleur demandée, ni d’atout, il peut jouer la carte de son choix.
          </li>
        </ul>

        <p>Les règles pour savoir qui remporte le pli (hiérarchie des cartes, rôle de l’atout) restent identiques&nbsp;: seule l’<strong>obligation de fournir</strong> ou de couper change.</p>
      </section>

      <!-- 8. COMPTAGE FINAL & VICTOIRE -->
      <section class="rules__block" aria-labelledby="rules-scoring">
        <h2 id="rules-scoring">8) Comptage final et victoire</h2>
        <ul>
          <li>À la fin de la manche, on additionne les <strong>points des annonces</strong> et les <strong>points des 10 et As</strong> remportés dans les plis.</li>
          <li>Ce total est ajouté au <strong>score général</strong> de chaque joueur.</li>
          <li>Une nouvelle manche commence tant qu’aucun joueur n’a atteint ou dépassé <strong>1000 points</strong>.</li>
          <li>Si les deux joueurs dépassent 1000 points en même temps et sont à égalité, on joue une <strong>manche de départage</strong>.</li>
          <li>Le joueur ayant le <strong>score le plus élevé</strong> au moment où le seuil des 1000 points est franchi remporte la partie.</li>
        </ul>
      </section>
    </div>
  </section>


  <!-- ÉCRAN 3 : JEU (ton écran collé, sans boutons de nav) -->
  <section id="screen-game" class="screen">
    <main class="main">
      <div class="game">
        <!-- Barre compacte (hidden par défaut, visible en petit écran via CSS) -->
        <nav id="mini-info-bar" class="mini-info-bar" aria-label="Infos rapides">
          <button type="button" class="mini-info-btn" data-target="decl">Cartes annoncées</button>
          <button type="button" id="showtrick" class="mini-info-btn" data-target="trick">Dernier pli</button>
        </nav>

        <!-- Overlay réutilisable -->
        <div id="mini-overlay" class="mini-overlay" aria-hidden="true">
          <div class="mini-overlay_backdrop" data-close="1"></div>
          <div class="mini-overlay_panel" role="dialog" aria-modal="true" aria-labelledby="mini-overlay-title">
            <div class="mini-overlay_header">
              <h3 id="mini-overlay-title" class="mini-overlay_title">Aperçu</h3>
              <button type="button" class="mini-overlay_close" title="Fermer" data-close="1">✕</button>
            </div>
            <div class="mini-overlay_body" id="mini-overlay-body"></div>
          </div>
        </div>
        <div class="main_table">

          <!-- Bandeau du haut : scores, carte(s) jouée(s), pioche, atout -->
          <div class="main_top-screen">

            <!-- Score "normal" -->
            <div class="score-normal scoreNormal" id="score-normal">
              <div class="score-normal_result-box">
                <div class="score-normal_cards-in-stack">
                  <h2 class="score-normal_h2">Cartes dans le talon:</h2>
                  <h2 class="score-normal_h2" id="stack-count">0</h2>
                </div>
                <div class="score-normal_score">
                  <div class="score-normal_result score-normal_result-player">
                    <h3 class="score-normal_h3">Score joueur</h3>
                    <p class="score-normal_result_p" id="score-player">0</p>
                  </div>
                  <div class="score-normal_result score-normal_result-computer">
                    <h3 class="score-normal_h3">Score ordinateur</h3>
                    <p class="score-normal_result_p" id="score-computer">0</p>
                  </div>
                </div>
              </div>

              <!-- Déclarations -->
              <div class="score-normal_declarations-container">
                <div class="score-normal_declarations scoreNormalDeclarations">
                  <div class="score-normal_declarations-box">
                    <h2 class="score-normal_h2">Annonces</h2>
                    <div class="score-normal_declarations_player" id="decl-computer"></div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Score “compact” -->
            <div class="score-bowdlerized" id="score-compact">
              <h2 class="score-bowdlerized_header">Score:</h2>
              <div class="score-bowdlerized_player">
                <h3 class="score-bowdlerized_header">J:</h3>
                <h3 class="score-bowdlerized_score" id="score-compact-player">0</h3>
              </div>
              <div class="score-bowdlerized_player">
                <h3 class="score-bowdlerized_header">O:</h3>
                <h3 class="score-bowdlerized_score" id="score-compact-computer">0</h3>
              </div>
              <h4 class="score-bowdlerized_turn">Talon: <span id="score-compact-stack">0</span></h4>
            </div>

            <!-- Carte(s) jouée(s) -->
            <div class="cards-played" id="cards-played">
              <div class="cards-played_box">
                <div class="cards-played_computer">
                  <h3 class="cards-played_h3">Carte ordinateur</h3>
                  <div class="cards-played_slot" id="played-computer"></div>
                </div>
                <div class="cards-played_player">
                  <h3 class="cards-played_h3">Carte joueur</h3>
                  <div class="cards-played_slot" id="played-player"></div>
                </div>
              </div>
            </div>

            <!-- Pioche -->
            <div class="stack">
              <h2 id="stack-header" class="stack_header">Pioche</h2>
              <div id="stack_div" class="">
                <img id="stack-img" src="images/stack10.svg" alt="tas de la pioche" class="stack_img">
              </div>
            </div>

            <!-- Atout -->
            <div class="trump" id="trump">
              <h3 class="trump_header">Atout</h3>
              <div class="trump_slot" id="trump-card"><!-- carte d'atout injectée ici --></div>
            </div>

          </div>

          <!-- Bandeau milieu : cartes annoncées ordinateur + plis -->
          <div class="main_middle-screen">
            <!-- 10 cartes annoncées par l’ordinateur -->
            <div class="cards-declared-computer">
              <h3 class="cards-declared-computer_header">Cartes annoncées par l'ordinateur</h3>
              <div class="cards-declared-computer_cards" id="declared-computer">
                <!-- cartes annoncées ordi (0..10) -->
              </div>
            </div>

            <!-- Plis -->
            <div class="trick-piles">
              <h3 class="trick_header">Plis</h3>
              <div class="trick-stock LastTrickDesktop" id="trick-stacks"></div>

              <div class="trick-list-hidden trickListDesktop" id="last-trick">
                <h3 class="trick_h3">Dernier pli</h3>
                <ul class="trick_list" id="last-trick-list"></ul>
              </div>
            </div>
          </div>

          <!-- Zone joueur : 10 annoncées + 10 en main -->
          <div class="main_elements-player">
            <!-- 10 cartes annoncées par le joueur -->
            <div class="cards-declared-player">
              <h3 class="cards-declared-player_header">Cartes annoncées par le joueur</h3>
              <div class="cards-declared-player_cards-box" id="declared-player"></div>
            </div>

            <!-- 10 cartes en main du joueur -->
            <div class="cards-hand-player">
              <h2 class="cards-hand-player_header">Cartes en main</h2>
              <div class="cards-hand-player_carousel">
                <div class="cards-hand-player_ribon" id="hand-player"></div>
              </div>
            </div>
          </div>

        </div><!-- /.main_table -->
      </div><!-- /.game -->
    </main>
  </section>

  <!-- Inclusion des scripts du jeu --> 

  <!-- scripts fonctionnement graphiques --> 
  <script src="./scripts/graphiques/chart.umd.min.js"></script>
  <script src="./scripts/graphiques/graphiques.js"></script>
  <script src="./scripts/graphiques/filterByDifficulty.js"></script>

  <!-- scripts outils --> 
  <!-- scripts actions primaires du jeu --> 
  <script src="./scripts/game/utils/actions_jeu/computerChooseDeclaration.js"></script>
  <script src="./scripts/game/utils/actions_jeu/computerDeclare.js"></script>
  <script src="./scripts/game/utils/actions_jeu/computerDrawCard.js"></script>
  <script src="./scripts/game/utils/actions_jeu/computerPlayCard.js"></script>
  <script src="./scripts/game/utils/actions_jeu/drawLastTurn.js"></script>
  <script src="./scripts/game/utils/actions_jeu/playerDeclare.js"></script>
  <script src="./scripts/game/utils/actions_jeu/playerDrawCard.js"></script>
  <script src="./scripts/game/utils/actions_jeu/playerPlayCard.js"></script>
  <script src="./scripts/game/utils/actions_jeu/playTrickGame.js"></script>
  <!-- scripts aides générales -->
  <script src="./scripts/game/utils/aides_jeu/$.js"></script>
  <script src="./scripts/game/utils/aides_jeu/arrayAny.js"></script>
  <script src="./scripts/game/utils/aides_jeu/arraySort.js"></script>
  <script src="./scripts/game/utils/aides_jeu/byNumberOrName.js"></script>
  <script src="./scripts/game/utils/aides_jeu/getRankNum.js"></script>
  <script src="./scripts/game/utils/aides_jeu/has.js"></script>
  <script src="./scripts/game/utils/aides_jeu/playableCards.js"></script>
  <script src="./scripts/game/utils/aides_jeu/playerSortCards.js"></script>
  <script src="./scripts/game/utils/aides_jeu/playerSortCardsEndGame.js"></script>
  <script src="./scripts/game/utils/aides_jeu/safeScore.js"></script>
  <script src="./scripts/game/utils/aides_jeu/scoreCard.js"></script>
  <script src="./scripts/game/utils/aides_jeu/SCREENS.js"></script>
  <script src="./scripts/game/utils/aides_jeu/setActive.js"></script>
  <script src="./scripts/game/utils/aides_jeu/shuffleDeck.js"></script>
  <!-- scripts aides modales --> 
  <script src="./scripts/game/utils/aides_modales/applyAuroraTheme.js"></script>
  <script src="./scripts/game/utils/aides_modales/closeModal.js"></script>
  <script src="./scripts/game/utils/aides_modales/ensureModalRoot.js"></script>
  <script src="./scripts/game/utils/aides_modales/showModal.js"></script>
  <script src="./scripts/game/utils/aides_modales/showEndGif.js"></script>
  <!-- scripts aides renders --> 
  <script src="./scripts/game/utils/aides_renders/cardNode.js"></script>
  <script src="./scripts/game/utils/aides_renders/decidePlayerMode.js"></script>
  <script src="./scripts/game/utils/aides_renders/el.js"></script>
  <script src="./scripts/game/utils/aides_renders/ensureAnnouncedPlayerContainer.js"></script>
  <script src="./scripts/game/utils/aides_renders/ensureContainer.js"></script>
  <script src="./scripts/game/utils/aides_renders/namesFromScoreDeclarations.js"></script>
  <script src="./scripts/game/utils/aides_renders/partitionHandByAnnouncements.js"></script>
  <script src="./scripts/game/utils/aides_renders/qsAny.js"></script>
  <script src="./scripts/game/utils/aides_renders/renderCache.js"></script>
  <script src="./scripts/game/utils/aides_renders/setText.js"></script>
  <script src="./scripts/game/utils/aides_renders/sig.js"></script>
  <script src="./scripts/game/utils/aides_renders/taille_pioche.js"></script>
  <script src="./scripts/game/utils/aides_renders/updateEndgameFlag.js"></script>
  <!-- scripts aides annonces --> 
  <script src="./scripts/game/utils/annonces/brezinDeclarations.js"></script>
  <script src="./scripts/game/utils/annonces/couples.js"></script>
  <script src="./scripts/game/utils/annonces/findWithIdAndAddDeclaration.js"></script>
  <script src="./scripts/game/utils/annonces/fours.js"></script>
  <script src="./scripts/game/utils/annonces/isDeclared.js"></script>
  <script src="./scripts/game/utils/annonces/isNotDeclaredFor.js"></script>
  <script src="./scripts/game/utils/annonces/isNotDeclaredForSmthLike.js"></script>
  <script src="./scripts/game/utils/annonces/isDeclaredForSmthLike.js"></script>
  <script src="./scripts/game/utils/annonces/isSevenDecl.js"></script>
  <script src="./scripts/game/utils/annonces/possibleDeclarations.js"></script>
  <script src="./scripts/game/utils/annonces/returnCardIds.js"></script>
  <script src="./scripts/game/utils/annonces/selectedCardsCouple.js"></script>
  <script src="./scripts/game/utils/annonces/selectedCardsFour.js"></script>
  <script src="./scripts/game/utils/annonces/selectedCardsLittleBrezin.js"></script>
  <script src="./scripts/game/utils/annonces/selectedCardTwoFifty.js"></script>
  <script src="./scripts/game/utils/annonces/sevenTrump.js"></script>
  <script src="./scripts/game/utils/annonces/twoFifty.js"></script>
  <script src="./scripts/game/utils/annonces/undeclareCards.js"></script>
  <!-- scripts aides probabilités --> 
  <script src="./scripts/game/utils/probabilites/binomialCoefficient.js"></script>
  <script src="./scripts/game/utils/probabilites/equalProb.js"></script>
  <script src="./scripts/game/utils/probabilites/probability250Gain.js"></script>
  <script src="./scripts/game/utils/probabilites/probabilityGain.js"></script>

  <!-- script lancement du jeu --> 
  <script src="./scripts/game/main.js"></script>

  <!-- scripts fonctionnement de l'IA --> 
  <script src="./scripts/game/core/IA/computerPlayFirst.js"></script>
  <script src="./scripts/game/core/IA/computerPlayFirstEndGame.js"></script>
  <script src="./scripts/game/core/IA/computerPlaySecond.js"></script>
  <script src="./scripts/game/core/IA/computerPlaySecondEndGame.js"></script>
  <script src="./scripts/game/core/IA/playFirstCardToLose.js"></script>
  <script src="./scripts/game/core/IA/playFirstCardToWinForSure.js"></script>
  <script src="./scripts/game/core/IA/playFirstCardToWinMaybe.js"></script>
  <script src="./scripts/game/core/IA/trickGameSimulation.js"></script>
  <!-- scripts calacul des consequences d'une carte --> 
  <script src="./scripts/game/core/IA/consequences/consequencesCard.js"></script>
  <!-- scripts calcul de la valeur d'une carte --> 
  <script src="./scripts/game/core/IA/value/brezinValue.js"></script>
  <script src="./scripts/game/core/IA/value/coupleValue.js"></script>
  <script src="./scripts/game/core/IA/value/fourValue.js"></script>
  <script src="./scripts/game/core/IA/value/littleBrezinValue.js"></script>
  <script src="./scripts/game/core/IA/value/twoFiftyValue.js"></script>
  <script src="./scripts/game/core/IA/value/valueCard.js"></script>
  <!-- scripts listeners --> 
  <script src="./scripts/game/core/listeners/listenerChoiceDifficulty.js"></script>
  <script src="./scripts/game/core/listeners/listenerComputerPlayFirst.js"></script>
  <script src="./scripts/game/core/listeners/listenerDeal.js"></script>
  <script src="./scripts/game/core/listeners/listenerDeclare.js"></script>
  <script src="./scripts/game/core/listeners/listenerDraw.js"></script>
  <script src="./scripts/game/core/listeners/listenerEndRound.js"></script>
  <script src="./scripts/game/core/listeners/listenerInit.js"></script>
  <script src="./scripts/game/core/listeners/listenerNewRound.js"></script>
  <script src="./scripts/game/core/listeners/listenerPlayerPlayFirst.js"></script>
  <script src="./scripts/game/core/listeners/listenerPlayerPlaySecond.js"></script>
  <script src="./scripts/game/core/listeners/listenerPlayerWonTrick.js"></script>
  <script src="./scripts/game/core/listeners/listenerShowDeclarationComputer.js"></script>
  <script src="./scripts/game/core/listeners/listenerShowSecondDeclarationComputer.js"></script>

  
  <!-- Scripts Dialogues-->
  <script src="./scripts/game/utils/dialogues/removeComments.js"></script>
  <script src="./scripts/game/utils/dialogues/SITUATION_KEYS.js"></script>
  <script src="./scripts/game/utils/dialogues/SCORE_CONTEXT_KEYS.js"></script>
  <script src="./scripts/game/utils/dialogues/SCORE_CONTEXT_VALENCE.js"></script>
  <script src="./scripts/game/utils/dialogues/EVENT_VALENCE.js"></script>
  <script src="./scripts/game/utils/dialogues/CChooseSentance.js"></script>
  <script src="./scripts/game/utils/dialogues/AI_BY_DIFF.js"></script>
  <script src="./scripts/game/utils/dialogues/dialogues.js"></script>
  <script src="./scripts/game/utils/dialogues/buildDialogueContext.js"></script>
  <script src="./scripts/game/utils/dialogues/estimatePossibleEqual.js"></script>
  <script src="./scripts/game/utils/dialogues/calculateSituationRate.js"></script>
  <script src="./scripts/game/utils/dialogues/AIPersonality.js"></script>
  <script src="./scripts/game/utils/dialogues/pickEmotionFromValence.js"></script>
  <script src="./scripts/game/utils/dialogues/AIGenerateDialogue.js"></script>
  <script src="./scripts/game/utils/dialogues/gameStartMessage.js"></script>
  
  <!-- script gestion du responsive du jeu --> 
  <script src="./scripts/game/responsive/responsive.js"></script>

  <!-- scripts affichage des éléments à l'écran --> 
  <!-- scripts affichage des modales --> 
  <script src="./scripts/game/ui/modales/showComputerDeclarationModal.js"></script>
  <script src="./scripts/game/ui/modales/showDifficultyChoiceModal.js"></script>
  <script src="./scripts/game/ui/modales/showEndOfGameModal.js"></script>
  <script src="./scripts/game/ui/modales/showEndOfRoundModal.js"></script>
  <script src="./scripts/game/ui/modales/showPlayerDeclarationModal.js"></script>
  <script src="./scripts/game/ui/modales/showTrickModal.js"></script>
  <!-- scripts affichage des éléments de l'écran principal du jeu --> 
  <script src="./scripts/game/ui/renders/renderCards.js"></script>
  <script src="./scripts/game/ui/renders/renderCardsInto.js"></script>
  <script src="./scripts/game/ui/renders/renderCardsLikeHand.js"></script>
  <script src="./scripts/game/ui/renders/renderDeclaration.js"></script>
  <script src="./scripts/game/ui/renders/renderDeclarationTotals.js"></script>
  <script src="./scripts/game/ui/renders/renderDeclaredZones.js"></script>
  <script src="./scripts/game/ui/renders/renderGame.js"></script>
  <script src="./scripts/game/ui/renders/renderHand.js"></script>
  <script src="./scripts/game/ui/renders/renderPlayed.js"></script>
  <script src="./scripts/game/ui/renders/renderScores.js"></script>
  <script src="./scripts/game/ui/renders/renderStack.js"></script>
  <script src="./scripts/game/ui/renders/renderStackPile.js"></script>
  <script src="./scripts/game/ui/renders/renderTricks.js"></script>
  <script src="./scripts/game/ui/renders/renderTrump.js"></script>
  <script src="./scripts/game/ui/renders/wireLastTrickPopover.js"></script>
  <script src="./scripts/game/ui/renders/addingPointAnimation.js"></script>
  <script src="./scripts/game/ui/renders/scoreAnimator.js"></script>
  <script src="./scripts/game/ui/renders/setAiEmotion.js"></script>

  <script src="./scripts/audio/audioManager.js"></script>
  <script src="./scripts/audio/playSound.js"></script>
</body>
</html>